@startuml web5claims-detailed-flow
!theme cerulean-outline

title Web5 Claims - Detailed ZK Language Learning Certificate Flow\n**ZK Hack Berlin 2024**

actor "ğŸ‘¨â€ğŸ“\nLanguage Learner" as learner
participant "ğŸ®\nKonnektoren\nLearning Platform" as konnektoren
participant "ğŸŒ\nWeb5 Claims UI\n(Yew Frontend)" as ui
participant "ğŸ”\nCertificate Issuer\n(Rust Backend)" as issuer
participant "âœ…\nZK Proof Verifier\n(Rust Backend)" as verifier
participant "âš™ï¸\nAleo Platform\n(ZK Circuits)" as aleo
participant "ğŸ¢\nEmployer/University\n(Relying Party)" as employer

== ğŸ“ Learning & Certificate Generation ==
learner -> konnektoren: Complete German B2 Course
activate konnektoren

konnektoren -> konnektoren: Generate CertificateData
note right
**Certificate Fields:**
â€¢ game_path_name: "German_B2_Complete"
â€¢ total_challenges: 50
â€¢ solved_challenges: 47
â€¢ performance_percentage: 94
â€¢ profile_name: "Language Learner"
â€¢ date: 2024-01-15T10:30:00Z
â€¢ signature: Ed25519 signature
end note

konnektoren -> konnektoren: Sign Certificate with Ed25519
konnektoren -> learner: Issue Signed Certificate
deactivate konnektoren

== ğŸŒ Web5 Claims UI Interaction ==
learner -> ui: Open Web5 Claims App
activate ui

ui -> learner: Show Certificate Form
learner -> ui: Input Certificate Data
ui -> ui: Validate Form & Preview Performance

learner -> ui: Click "ğŸ“ Generate Certificate"
ui -> ui: Create CertificateData Object
ui -> learner: Display Certificate Image & Stats

== ğŸ” ZK Proof Generation ==
learner -> ui: Click "ğŸš€ Generate Aleo ZK Proof"
ui -> issuer: Create ProofRequest
activate issuer

note over issuer
**ProofRequest:**
â€¢ certificate: CertificateData
â€¢ claim_type: LanguageProficiency {
    language: "German",
    min_level: CefrLevel::B2
  }
â€¢ target_platform: "aleo"
â€¢ options: ProofOptions::default()
end note

issuer -> issuer: Validate Certificate
issuer -> issuer: Extract Language & CEFR Level
issuer -> issuer: Check: cert_level >= min_level
issuer -> issuer: Generate Certificate Hash

issuer -> aleo: Generate ZK Proof
activate aleo

note over aleo
**Aleo ZK Circuit: language_proficiency_v1**
```
transition verify_language_skill(
    private cert_level: u8,       // 4 (B2)
    private performance: u8,      // 94
    private student_hash: field,  // SHA256(profile)
    public min_level: u8,         // 4 (B2)
    public language: field,       // hash("German")
) -> bool {
    return cert_level >= min_level;
}
```
**Proves:** Has German B2+ without revealing exact level/score
end note

aleo -> aleo: Execute ZK Circuit
aleo -> issuer: Return ZK Proof Bytes
deactivate aleo

issuer -> issuer: Create ZkProofClaim
note right
**ZkProofClaim:**
â€¢ proof_id: UUID
â€¢ claim_type: LanguageProficiency
â€¢ public_inputs: {
    "min_level": "B2",
    "language": "German",
    "verification_result": true,
    "certificate_hash": "sha256..."
  }
â€¢ proof_data: {
    "proof_bytes": [ZK proof],
    "circuit_id": "language_proficiency_v1",
    "vk_hash": "verification_key_hash"
  }
â€¢ metadata: {
    "platform": "aleo",
    "issuer_id": "web5_claims_issuer"
  }
end note

issuer -> ui: Return ZkProofClaim
deactivate issuer

ui -> learner: âœ… "ZK Proof Generated Successfully!"
deactivate ui

== ğŸ’¼ Employment Verification Scenario ==
learner -> employer: "I have German B2+ proficiency"
employer -> learner: "Please provide verifiable proof"

learner -> employer: Submit ZK Proof (JSON/Base64)
employer -> verifier: Verify ZK Proof
activate verifier

verifier -> verifier: Check Proof Integrity
verifier -> verifier: Validate Platform Support
verifier -> verifier: Verify Circuit Trust
note right
**Trusted Circuits:**
â€¢ language_proficiency_v1 âœ…
â€¢ performance_threshold_v1 âœ…
â€¢ completion_date_v1 âœ…
â€¢ combined_criteria_v1 âœ…
end note

verifier -> aleo: Verify Proof On-Chain
activate aleo
aleo -> aleo: Run Verification Algorithm
aleo -> verifier: âœ… Proof Valid
deactivate aleo

verifier -> verifier: Create VerificationResult
note right
**VerificationResult:**
â€¢ is_valid: true
â€¢ requirements_met: true
â€¢ details: {
    "platform": "aleo",
    "circuit_id": "language_proficiency_v1",
    "verified_at": "2024-01-15T11:00:00Z",
    "verified_inputs": {
      "min_level": "B2",
      "language": "German"
    }
  }
â€¢ warnings: []
end note

verifier -> employer: Return VerificationResult
deactivate verifier

employer -> employer: Process Verification
employer -> learner: âœ… "German B2+ Competency Verified!"

== ğŸ“Š Privacy Comparison ==
note over learner, employer
**ğŸ” What was PROVEN (Public):**
âœ… Has German language certification
âœ… Achieved B2 level or higher
âœ… Certificate issued after Jan 2023
âœ… Valid cryptographic signature

**âŒ What was HIDDEN (Private):**
âŒ Exact CEFR level (could be B2, C1, or C2)
âŒ Exact performance score (94%)
âŒ Number of challenges completed (47/50)
âŒ Student's real name
âŒ Exact completion date
âŒ Institution details
end note

== ğŸ† ZK Hack Berlin Prize Tracks ==
note over ui, aleo
**ğŸ† Prize Track Alignment:**
ğŸ¥‡ **Aleo ($5K)**: Native Aleo ZK circuits for education
ğŸ—ï¸ **Arbitrum Stylus ($1K)**: Rust ZK verifier deployment
ğŸ” **ZKPassport ($1K)**: Private identity verification
ğŸ‘¥ **Xion ($3K)**: Consumer-friendly ZK UX
ğŸ† **Main Prize ($9K)**: Novel ZK education application
end note

@enduml
